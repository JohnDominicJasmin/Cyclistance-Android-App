Index: app/src/main/java/com/example/cyclistance/service/MessagingService.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.service\n\nimport com.google.firebase.messaging.FirebaseMessagingService\nimport com.google.firebase.messaging.RemoteMessage\nimport timber.log.Timber\n\nclass MessagingService : FirebaseMessagingService() {\n    override fun onNewToken(token: String) {\n        super.onNewToken(token)\n        Timber.v(\"New token: $token\")\n    }\n\n    override fun onMessageReceived(message: RemoteMessage) {\n        super.onMessageReceived(message)\n        Timber.v(\"Message received: $message\" + message.notification?.body)\n    }\n}\n\n\n//fGtbXXW6Qp22e26yumWnU5:APA91bEgPAOKv-RMnQwlHPXze6mdoaLlxnML8-LUiazLECNWTxX3KhVGMcvG1F9mS0SdUay0IqB-OtQvkLOPVspOx32SZ32gYLQujV42P9mfINmK20nBr-XynRWf5hIpIbSf1MHmDPor
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/service/MessagingService.kt b/app/src/main/java/com/example/cyclistance/service/MessagingService.kt
--- a/app/src/main/java/com/example/cyclistance/service/MessagingService.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/service/MessagingService.kt	(date 1691167847627)
@@ -1,18 +1,85 @@
 package com.example.cyclistance.service
 
+import android.annotation.SuppressLint
+import android.app.NotificationChannel
+import android.app.NotificationManager
+import android.app.PendingIntent
+import android.content.Intent
+import android.os.Build
+import androidx.core.app.NotificationCompat
+import androidx.core.app.NotificationManagerCompat
+import com.example.cyclistance.MainActivity
+import com.example.cyclistance.R
+import com.example.cyclistance.core.utils.constants.MessagingConstants.CHANNEL_DESCRIPTION
+import com.example.cyclistance.core.utils.constants.MessagingConstants.CHANNEL_IMPORTANCE
+import com.example.cyclistance.core.utils.constants.MessagingConstants.CHANNEL_NAME
+import com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_FCM_TOKEN
+import com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_MESSAGE
+import com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_NAME
+import com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_UID
+import com.example.cyclistance.core.utils.constants.MessagingConstants.MESSAGING_NOTIFICATION_CHANNEL
+import com.example.cyclistance.core.utils.constants.MessagingConstants.MESSAGING_NOTIFICATION_ID
+import com.example.cyclistance.core.utils.constants.MessagingConstants.NOTIFICATION_REQUEST_CODE
 import com.google.firebase.messaging.FirebaseMessagingService
 import com.google.firebase.messaging.RemoteMessage
 import timber.log.Timber
+import javax.inject.Inject
 
-class MessagingService : FirebaseMessagingService() {
+class MessagingService @Inject constructor() : FirebaseMessagingService() {
     override fun onNewToken(token: String) {
         super.onNewToken(token)
-        Timber.v("New token: $token")
+        Timber.v("FirebaseMessagingService New token: $token")
     }
 
+
+    @SuppressLint("MissingPermission")
     override fun onMessageReceived(message: RemoteMessage) {
         super.onMessageReceived(message)
         Timber.v("Message received: $message" + message.notification?.body)
+
+        val data = message.data
+        val uid = data[KEY_UID] ?: "Empty Uid"
+        val name = data[KEY_NAME] ?: "Empty Name"
+        val fcmToken = data[KEY_FCM_TOKEN] ?: "Empty FcmToken"
+        val message = data[KEY_MESSAGE] ?: ""
+
+        val intent = Intent(this, MainActivity::class.java).apply {
+            flags = Intent.FLAG_ACTIVITY_NEW_TASK or Intent.FLAG_ACTIVITY_CLEAR_TASK
+            putExtra(KEY_UID, uid)
+            putExtra(KEY_NAME, name)
+            putExtra(KEY_FCM_TOKEN, fcmToken)
+        }
+
+        val pendingIntent = PendingIntent.getActivity(
+            this,
+            NOTIFICATION_REQUEST_CODE,
+            intent,
+            PendingIntent.FLAG_MUTABLE or PendingIntent.FLAG_UPDATE_CURRENT)
+
+        val notificationStyle = NotificationCompat.BigTextStyle().bigText(message)
+        val notificationCompat = NotificationCompat.Builder(this, MESSAGING_NOTIFICATION_CHANNEL).apply {
+            setSmallIcon(R.drawable.ic_baseline_notifications_24)
+            setContentTitle("New Message from $name")
+            setContentText(message)
+            setStyle(notificationStyle)
+            priority = NotificationCompat.PRIORITY_HIGH
+            setContentIntent(pendingIntent)
+            setAutoCancel(true)
+
+        }
+
+        if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
+            val notificationChannel = NotificationChannel( MESSAGING_NOTIFICATION_CHANNEL, CHANNEL_NAME, CHANNEL_IMPORTANCE).apply {
+                description = CHANNEL_DESCRIPTION
+            }
+            val notificationManager = getSystemService(NotificationManager::class.java)
+            notificationManager.createNotificationChannel(notificationChannel)
+        }
+
+        val notificationManagerCompat = NotificationManagerCompat.from(this)
+        notificationManagerCompat.notify(MESSAGING_NOTIFICATION_ID, notificationCompat.build())
+
+
     }
 }
 
Index: app/src/main/java/com/example/cyclistance/navigation/event/NavUiEvent.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.navigation.event\n\nsealed class NavUiEvent{\n    data class OnChangeNavigation(val isNavigating:Boolean): NavUiEvent()\n    object OnToggleTheme: NavUiEvent()\n    data class NewConversationDetails(val chatName: String, val chatPhotoUrl: String, val chatAvailability: Boolean): NavUiEvent()\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/navigation/event/NavUiEvent.kt b/app/src/main/java/com/example/cyclistance/navigation/event/NavUiEvent.kt
--- a/app/src/main/java/com/example/cyclistance/navigation/event/NavUiEvent.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/navigation/event/NavUiEvent.kt	(date 1691249134669)
@@ -1,7 +1,9 @@
 package com.example.cyclistance.navigation.event
 
+import com.example.cyclistance.feature_messaging.domain.model.ui.chats.MessagingUserItemModel
+
 sealed class NavUiEvent{
     data class OnChangeNavigation(val isNavigating:Boolean): NavUiEvent()
     object OnToggleTheme: NavUiEvent()
-    data class NewConversationDetails(val chatName: String, val chatPhotoUrl: String, val chatAvailability: Boolean): NavUiEvent()
+    data class NewConversationDetails(val conversationUser: MessagingUserItemModel): NavUiEvent()
 }
Index: app/src/main/java/com/example/cyclistance/navigation/nav_graph/NavGraph.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.navigation.nav_graph\n\nimport androidx.compose.animation.core.tween\nimport androidx.compose.animation.fadeIn\nimport androidx.compose.animation.fadeOut\nimport androidx.compose.foundation.layout.PaddingValues\nimport androidx.compose.runtime.Composable\nimport androidx.navigation.NavController\nimport androidx.navigation.NavHostController\nimport androidx.navigation.compose.NavHost\nimport com.example.cyclistance.navigation.event.NavUiEvent\nimport com.example.cyclistance.navigation.state.NavUiState\nimport com.google.accompanist.permissions.ExperimentalPermissionsApi\n\n\n@ExperimentalPermissionsApi\n@Composable\nfun NavGraph(\n    navController: NavHostController,\n    paddingValues: PaddingValues,\n    uiState: NavUiState,\n    event: (NavUiEvent) -> Unit) {\n\n\n    NavHost(\n        navController = navController,\n        startDestination = uiState.startingDestination,\n        enterTransition = {\n            fadeIn(\n                animationSpec = tween(\n                    durationMillis = 300))\n        },\n        exitTransition = {\n            fadeOut(\n                animationSpec = tween(\n                    durationMillis = 300))\n        }) {\n\n\n        authenticationGraph(\n            navController = navController,\n            paddingValues = paddingValues,\n        )\n\n        mappingGraph(\n            navController = navController,\n            paddingValues = paddingValues,\n            hasInternetConnection = uiState.internetAvailable,\n            isNavigating = uiState.isNavigating,\n            onChangeNavigatingState = { event(NavUiEvent.OnChangeNavigation(it)) }\n        )\n\n        emergencyCallGraph(\n            navController = navController,\n            paddingValues = paddingValues\n        )\n\n        messagingGraph(\n            navController = navController,\n            paddingValues = paddingValues,\n            isInternetAvailable = uiState.internetAvailable,\n            newConversationDetails = { name, photoUrl, availability ->\n                event(\n                    NavUiEvent.NewConversationDetails(\n                        chatName = name,\n                        chatPhotoUrl = photoUrl,\n                        chatAvailability = availability))\n            }\n        )\n\n        onBoardingGraph(\n            navController = navController,\n            paddingValues = paddingValues\n        )\n\n        settingGraph(\n            navController = navController,\n            paddingValues = paddingValues,\n            onToggleTheme = { event(NavUiEvent.OnToggleTheme) }\n        )\n\n        rideHistoryGraph(\n            navController = navController,\n            paddingValues = paddingValues\n        )\n\n    }\n}\n\n\nfun NavController.navigateScreenInclusively(\n    destination: String,\n    popUpToDestination: String) {\n    navigate(destination) {\n        popUpTo(popUpToDestination) {\n            inclusive = true\n        }\n        launchSingleTop = true\n    }\n\n}\n\nfun NavController.navigateScreen(\n    route: String) {\n    navigate(route) {\n        popUpTo(route) {\n            saveState = true\n\n        }\n        restoreState = true\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/navigation/nav_graph/NavGraph.kt b/app/src/main/java/com/example/cyclistance/navigation/nav_graph/NavGraph.kt
--- a/app/src/main/java/com/example/cyclistance/navigation/nav_graph/NavGraph.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/navigation/nav_graph/NavGraph.kt	(date 1691249158092)
@@ -59,12 +59,9 @@
             navController = navController,
             paddingValues = paddingValues,
             isInternetAvailable = uiState.internetAvailable,
-            newConversationDetails = { name, photoUrl, availability ->
+            newConversationDetails = {
                 event(
-                    NavUiEvent.NewConversationDetails(
-                        chatName = name,
-                        chatPhotoUrl = photoUrl,
-                        chatAvailability = availability))
+                    NavUiEvent.NewConversationDetails(conversationUser = it))
             }
         )
 
Index: .idea/deploymentTargetDropDown.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"deploymentTargetDropDown\">\n    <runningDeviceTargetSelectedWithDropDown>\n      <Target>\n        <type value=\"RUNNING_DEVICE_TARGET\" />\n        <deviceKey>\n          <Key>\n            <type value=\"VIRTUAL_DEVICE_PATH\" />\n            <value value=\"$USER_HOME$/.android/avd/Pixel_5_API_27.avd\" />\n          </Key>\n        </deviceKey>\n      </Target>\n    </runningDeviceTargetSelectedWithDropDown>\n    <timeTargetWasSelectedWithDropDown value=\"2023-08-05T11:13:45.959305664Z\" />\n    <multipleDevicesSelectedInDropDown value=\"true\" />\n    <runningDeviceTargetsSelectedWithDialog>\n      <Target>\n        <type value=\"RUNNING_DEVICE_TARGET\" />\n        <deviceKey>\n          <Key>\n            <type value=\"SERIAL_NUMBER\" />\n            <value value=\"194a89050404\" />\n          </Key>\n        </deviceKey>\n      </Target>\n    </runningDeviceTargetsSelectedWithDialog>\n    <targetsSelectedWithDialog>\n      <Target>\n        <type value=\"QUICK_BOOT_TARGET\" />\n        <deviceKey>\n          <Key>\n            <type value=\"VIRTUAL_DEVICE_PATH\" />\n            <value value=\"$USER_HOME$/.android/avd/Pixel_5_API_27.avd\" />\n          </Key>\n        </deviceKey>\n      </Target>\n    </targetsSelectedWithDialog>\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/deploymentTargetDropDown.xml b/.idea/deploymentTargetDropDown.xml
--- a/.idea/deploymentTargetDropDown.xml	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/.idea/deploymentTargetDropDown.xml	(date 1691245280975)
@@ -12,8 +12,7 @@
         </deviceKey>
       </Target>
     </runningDeviceTargetSelectedWithDropDown>
-    <timeTargetWasSelectedWithDropDown value="2023-08-05T11:13:45.959305664Z" />
-    <multipleDevicesSelectedInDropDown value="true" />
+    <timeTargetWasSelectedWithDropDown value="2023-08-05T14:21:12.088526022Z" />
     <runningDeviceTargetsSelectedWithDialog>
       <Target>
         <type value="RUNNING_DEVICE_TARGET" />
Index: app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/event/ConversationVmEvent.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.feature_messaging.presentation.conversation.event\n\nimport com.example.cyclistance.feature_messaging.domain.model.SendMessageModel\n\nsealed class ConversationVmEvent {\n    data class SendMessage(val sendMessageModel: SendMessageModel) : ConversationVmEvent()\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/event/ConversationVmEvent.kt b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/event/ConversationVmEvent.kt
--- a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/event/ConversationVmEvent.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/event/ConversationVmEvent.kt	(date 1691250067025)
@@ -1,7 +1,9 @@
 package com.example.cyclistance.feature_messaging.presentation.conversation.event
 
 import com.example.cyclistance.feature_messaging.domain.model.SendMessageModel
+import com.example.cyclistance.feature_messaging.domain.model.ui.chats.MessagingUserItemModel
 
 sealed class ConversationVmEvent {
     data class SendMessage(val sendMessageModel: SendMessageModel) : ConversationVmEvent()
+    data class OnSelectedConversation(val messageUser: MessagingUserItemModel) : ConversationVmEvent()
 }
Index: app/src/main/java/com/example/cyclistance/navigation/nav_graph/MessagingGraph.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.navigation.nav_graph\n\nimport androidx.compose.foundation.layout.PaddingValues\nimport androidx.navigation.NavController\nimport androidx.navigation.NavGraphBuilder\nimport androidx.navigation.NavType\nimport androidx.navigation.compose.composable\nimport androidx.navigation.navArgument\nimport androidx.navigation.navigation\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_AVAILABILITY\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_ID\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_NAME\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_PHOTO_URL\nimport com.example.cyclistance.feature_messaging.presentation.chat.chats.ChatsScreen\nimport com.example.cyclistance.feature_messaging.presentation.conversation.ConversationScreen\nimport com.example.cyclistance.feature_messaging.presentation.search_user.SearchUserScreen\nimport com.example.cyclistance.navigation.Screens\n\nfun NavGraphBuilder.messagingGraph(\n    navController: NavController,\n    paddingValues: PaddingValues,\n    isInternetAvailable: Boolean,\n    newConversationDetails: (name: String, photoUrl: String, availability: Boolean) -> Unit) {\n\n    navigation(\n        startDestination = Screens.MessagingNavigation.ChatScreen.screenRoute,\n        route = Screens.MessagingNavigation.ROUTE\n    ) {\n\n\n        composable(Screens.MessagingNavigation.ChatScreen.screenRoute, ) {\n            ChatsScreen(\n                navController = navController,\n                paddingValues = paddingValues,\n                isInternetAvailable = isInternetAvailable\n            )\n        }\n\n        composable(Screens.MessagingNavigation.SearchUserScreen.screenRoute,         ) {\n            SearchUserScreen(\n                navController = navController,\n                paddingValues = paddingValues\n            )\n        }\n\n        composable(route = Screens.MessagingNavigation.ConversationScreen.screenRoute + \"/{$CHAT_ID}/{${CHAT_PHOTO_URL}}/{$CHAT_NAME}/{$CHAT_AVAILABILITY}\",\n            arguments = listOf(\n                navArgument(CHAT_ID) { type = NavType.StringType },\n                navArgument(CHAT_PHOTO_URL) { type = NavType.StringType },\n                navArgument(CHAT_NAME) { type = NavType.StringType },\n                navArgument(CHAT_AVAILABILITY) { type = NavType.BoolType }),\n        ) {\n\n            ConversationScreen(\n                navController = navController,\n                paddingValues = paddingValues,\n                newConversationDetails = newConversationDetails\n            )\n        }\n\n\n    }\n}\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/navigation/nav_graph/MessagingGraph.kt b/app/src/main/java/com/example/cyclistance/navigation/nav_graph/MessagingGraph.kt
--- a/app/src/main/java/com/example/cyclistance/navigation/nav_graph/MessagingGraph.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/navigation/nav_graph/MessagingGraph.kt	(date 1691250972676)
@@ -3,14 +3,9 @@
 import androidx.compose.foundation.layout.PaddingValues
 import androidx.navigation.NavController
 import androidx.navigation.NavGraphBuilder
-import androidx.navigation.NavType
 import androidx.navigation.compose.composable
-import androidx.navigation.navArgument
 import androidx.navigation.navigation
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_AVAILABILITY
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_ID
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_NAME
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_PHOTO_URL
+import com.example.cyclistance.feature_messaging.domain.model.ui.chats.MessagingUserItemModel
 import com.example.cyclistance.feature_messaging.presentation.chat.chats.ChatsScreen
 import com.example.cyclistance.feature_messaging.presentation.conversation.ConversationScreen
 import com.example.cyclistance.feature_messaging.presentation.search_user.SearchUserScreen
@@ -20,7 +15,7 @@
     navController: NavController,
     paddingValues: PaddingValues,
     isInternetAvailable: Boolean,
-    newConversationDetails: (name: String, photoUrl: String, availability: Boolean) -> Unit) {
+    newConversationDetails: (MessagingUserItemModel) -> Unit) {
 
     navigation(
         startDestination = Screens.MessagingNavigation.ChatScreen.screenRoute,
@@ -43,19 +38,18 @@
             )
         }
 
-        composable(route = Screens.MessagingNavigation.ConversationScreen.screenRoute + "/{$CHAT_ID}/{${CHAT_PHOTO_URL}}/{$CHAT_NAME}/{$CHAT_AVAILABILITY}",
-            arguments = listOf(
-                navArgument(CHAT_ID) { type = NavType.StringType },
-                navArgument(CHAT_PHOTO_URL) { type = NavType.StringType },
-                navArgument(CHAT_NAME) { type = NavType.StringType },
-                navArgument(CHAT_AVAILABILITY) { type = NavType.BoolType }),
-        ) {
+        composable(route = Screens.MessagingNavigation.ConversationScreen.screenRoute) {
 
-            ConversationScreen(
-                navController = navController,
-                paddingValues = paddingValues,
-                newConversationDetails = newConversationDetails
-            )
+            val selectedUser = navController.currentBackStackEntry?.savedStateHandle?.get<MessagingUserItemModel>("user")
+
+            selectedUser?.let { it1 ->
+                ConversationScreen(
+                    navController = navController,
+                    paddingValues = paddingValues,
+                    selectedUser = it1,
+                    newConversationDetails = newConversationDetails
+                )
+            }
         }
 
 
Index: app/src/main/java/com/example/cyclistance/navigation/components/TopAppBar.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.navigation.components\n\nimport androidx.compose.animation.AnimatedVisibility\nimport androidx.compose.animation.animateContentSize\nimport androidx.compose.animation.core.Spring\nimport androidx.compose.animation.core.spring\nimport androidx.compose.animation.core.tween\nimport androidx.compose.animation.fadeIn\nimport androidx.compose.animation.fadeOut\nimport androidx.compose.foundation.layout.Arrangement\nimport androidx.compose.foundation.layout.Row\nimport androidx.compose.foundation.layout.fillMaxWidth\nimport androidx.compose.foundation.layout.padding\nimport androidx.compose.foundation.layout.wrapContentSize\nimport androidx.compose.material.Icon\nimport androidx.compose.material.IconButton\nimport androidx.compose.material.MaterialTheme\nimport androidx.compose.material.Surface\nimport androidx.compose.material.icons.Icons\nimport androidx.compose.material.icons.filled.ArrowBack\nimport androidx.compose.material.icons.filled.Close\nimport androidx.compose.material.icons.filled.Search\nimport androidx.compose.runtime.Composable\nimport androidx.compose.ui.Alignment\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.tooling.preview.Preview\nimport androidx.compose.ui.unit.dp\nimport com.example.cyclistance.core.utils.constants.EmergencyCallConstants.SHOULD_OPEN_CONTACT_DIALOG\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_AVAILABILITY\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_ID\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_NAME\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_PHOTO_URL\nimport com.example.cyclistance.core.utils.constants.NavigationConstants.CANCELLATION_TYPE\nimport com.example.cyclistance.core.utils.constants.NavigationConstants.CLIENT_ID\nimport com.example.cyclistance.core.utils.constants.NavigationConstants.LATITUDE\nimport com.example.cyclistance.core.utils.constants.NavigationConstants.LONGITUDE\nimport com.example.cyclistance.core.utils.constants.NavigationConstants.TRANSACTION_ID\nimport com.example.cyclistance.feature_messaging.presentation.common.MessageUserImage\nimport com.example.cyclistance.navigation.Screens\nimport com.example.cyclistance.navigation.state.NavUiState\nimport com.example.cyclistance.theme.CyclistanceTheme\nimport com.example.cyclistance.top_bars.DefaultTopBar\nimport com.example.cyclistance.top_bars.TitleTopAppBar\nimport com.example.cyclistance.top_bars.TopAppBarCreator\n\n@Composable\nfun TopAppBar(\n    onClickArrowBackIcon: () -> Unit = {},\n    onClickMenuIcon: () -> Unit = {},\n    onClickSearchMessagingUser: () -> Unit = {},\n    uiState: NavUiState,\n    route: String?) {\n\n    when (route) {\n\n        Screens.MappingNavigation.MappingScreen.screenRoute -> {\n            AnimatedVisibility(\n                visible = uiState.isNavigating.not(),\n                enter = fadeIn(initialAlpha = 0.4f, animationSpec = tween(durationMillis = 10000)),\n                exit = fadeOut(animationSpec = tween(durationMillis = 10000))) {\n\n                DefaultTopBar(onClickIcon = onClickMenuIcon)\n            }\n        }\n\n        \"${Screens.MappingNavigation.CancellationScreen.screenRoute}/{${CANCELLATION_TYPE}}/{${TRANSACTION_ID}}/{${CLIENT_ID}}\" -> {\n            TopAppBarCreator(\n                icon = Icons.Default.ArrowBack,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    TitleTopAppBar(title = \"Cancellation Reason\")\n                })\n        }\n\n        Screens.MappingNavigation.ConfirmDetailsScreen.screenRoute + \"?${LATITUDE}={${LATITUDE}}&${LONGITUDE}={${LONGITUDE}}\" -> {\n            TopAppBarCreator(\n                icon = Icons.Default.ArrowBack,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    TitleTopAppBar(\n                        title = \"Confirmation Details\")\n                })\n        }\n\n\n        Screens.SettingsNavigation.ChangePasswordScreen.screenRoute -> {\n            TopAppBarCreator(\n                icon = Icons.Default.ArrowBack,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    TitleTopAppBar(title = \"Change Password\")\n                })\n        }\n\n        Screens.SettingsNavigation.EditProfileScreen.screenRoute -> {\n            TopAppBarCreator(\n                icon = Icons.Default.ArrowBack,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    TitleTopAppBar(title = \"Edit Profile\")\n                })\n        }\n\n        Screens.SettingsNavigation.SettingScreen.screenRoute -> {\n            TopAppBarCreator(\n                icon = Icons.Default.ArrowBack,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    TitleTopAppBar(title = \"Settings\")\n                })\n        }\n\n        Screens.EmergencyCallNavigation.EmergencyCallScreen.screenRoute + \"?${SHOULD_OPEN_CONTACT_DIALOG}={${SHOULD_OPEN_CONTACT_DIALOG}}\" -> {\n\n            TopAppBarCreator(\n                icon = Icons.Default.ArrowBack,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    TitleTopAppBar(title = \"Emergency Call\")\n                })\n        }\n\n        Screens.MessagingNavigation.ChatScreen.screenRoute -> {\n\n            TopAppBarCreator(\n                icon = Icons.Default.ArrowBack,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    Row(\n                        modifier = Modifier.fillMaxWidth(),\n                        verticalAlignment = Alignment.CenterVertically,\n                        horizontalArrangement = Arrangement.SpaceBetween) {\n\n                        TitleTopAppBar(title = \"Chats\")\n                        IconButton(onClick = onClickSearchMessagingUser) {\n                            Icon(\n                                imageVector = Icons.Default.Search,\n                                contentDescription = \"Search\",\n                                tint = MaterialTheme.colors.onBackground,\n                            )\n                        }\n                    }\n                })\n        }\n\n        Screens.MessagingNavigation.ConversationScreen.screenRoute + \"/{$CHAT_ID}/{${CHAT_PHOTO_URL}}/{$CHAT_NAME}/{${CHAT_AVAILABILITY}}\" -> {\n            TopAppBarCreator(\n                icon = Icons.Default.Close,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n\n                    Row(\n                        modifier = Modifier.wrapContentSize(),\n                        verticalAlignment = Alignment.CenterVertically,\n                        horizontalArrangement = Arrangement.spacedBy(5.dp)) {\n\n                        MessageUserImage(\n                            modifier = Modifier,\n                            isOnline = if(!uiState.internetAvailable) null else uiState.conversationAvailability,\n                            photoUrl = uiState.conversationPhotoUrl)\n\n                        TitleTopAppBar(\n                            title = uiState.conversationName,\n                            modifier = Modifier\n                                .padding(start = 5.dp)\n                                .animateContentSize(animationSpec = spring(stiffness = Spring.StiffnessLow)))\n\n                    }\n                })\n        }\n\n        Screens.RideHistoryNavigation.RideHistoryScreen.screenRoute -> {\n            TopAppBarCreator(\n                icon = Icons.Default.ArrowBack,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    TitleTopAppBar(title = \"Ride History\")\n                })\n        }\n\n        Screens.RideHistoryNavigation.RideHistoryDetailsScreen.screenRoute -> {\n            TopAppBarCreator(\n                icon = Icons.Default.Close,\n                onClickIcon = onClickArrowBackIcon,\n                topAppBarTitle = {\n                    TitleTopAppBar(title = \"Rescue Details\")\n                })\n        }\n\n\n    }\n\n}\n\n\n@Preview\n@Composable\nfun PreviewTopAppBarDark() {\n    CyclistanceTheme(true) {\n        Surface(color = MaterialTheme.colors.background) {\n            TopAppBar(\n                route = Screens.SettingsNavigation.EditProfileScreen.screenRoute,\n                uiState = NavUiState(isNavigating = false))\n        }\n    }\n}\n\n\n@Preview\n@Composable\nfun PreviewTopAppBarLight() {\n    CyclistanceTheme(false) {\n        Surface(color = MaterialTheme.colors.background) {\n            TopAppBar(\n                route = Screens.SettingsNavigation.EditProfileScreen.screenRoute,\n                uiState = NavUiState(isNavigating = false))\n        }\n    }\n}\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/navigation/components/TopAppBar.kt b/app/src/main/java/com/example/cyclistance/navigation/components/TopAppBar.kt
--- a/app/src/main/java/com/example/cyclistance/navigation/components/TopAppBar.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/navigation/components/TopAppBar.kt	(date 1691248149353)
@@ -26,10 +26,6 @@
 import androidx.compose.ui.tooling.preview.Preview
 import androidx.compose.ui.unit.dp
 import com.example.cyclistance.core.utils.constants.EmergencyCallConstants.SHOULD_OPEN_CONTACT_DIALOG
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_AVAILABILITY
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_ID
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_NAME
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_PHOTO_URL
 import com.example.cyclistance.core.utils.constants.NavigationConstants.CANCELLATION_TYPE
 import com.example.cyclistance.core.utils.constants.NavigationConstants.CLIENT_ID
 import com.example.cyclistance.core.utils.constants.NavigationConstants.LATITUDE
@@ -143,7 +139,7 @@
                 })
         }
 
-        Screens.MessagingNavigation.ConversationScreen.screenRoute + "/{$CHAT_ID}/{${CHAT_PHOTO_URL}}/{$CHAT_NAME}/{${CHAT_AVAILABILITY}}" -> {
+        Screens.MessagingNavigation.ConversationScreen.screenRoute -> {
             TopAppBarCreator(
                 icon = Icons.Default.Close,
                 onClickIcon = onClickArrowBackIcon,
Index: app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/state/ConversationState.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.feature_messaging.presentation.conversation.state\n\nimport android.os.Parcelable\nimport com.example.cyclistance.core.utils.annotations.StableState\nimport kotlinx.parcelize.Parcelize\n\n\n@Parcelize\n@StableState\ndata class ConversationState(\n    val conversationName: String = \"\",\n    val conversationUid: String = \"\",\n    val conversationPhotoUrl: String = \"\",\n    val conversationAvailability: Boolean = false,\n    val userUid: String = \"\",\n    val userName: String = \"\",\n    val userPhoto: String = \"\",\n    val conversionId: String? = null,\n    val isLoading: Boolean = false\n) : Parcelable\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/state/ConversationState.kt b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/state/ConversationState.kt
--- a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/state/ConversationState.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/state/ConversationState.kt	(date 1691248998929)
@@ -2,16 +2,14 @@
 
 import android.os.Parcelable
 import com.example.cyclistance.core.utils.annotations.StableState
+import com.example.cyclistance.feature_messaging.domain.model.ui.chats.MessagingUserItemModel
 import kotlinx.parcelize.Parcelize
 
 
 @Parcelize
 @StableState
 data class ConversationState(
-    val conversationName: String = "",
-    val conversationUid: String = "",
-    val conversationPhotoUrl: String = "",
-    val conversationAvailability: Boolean = false,
+    val messageUser: MessagingUserItemModel = MessagingUserItemModel(),
     val userUid: String = "",
     val userName: String = "",
     val userPhoto: String = "",
Index: firestore-debug.log
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>Aug 05, 2023 7:03:39 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketServer start\nINFO: Started WebSocket server on ws://0.0.0.0:38041\nAPI endpoint: http://0.0.0.0:9299\nIf you are using a library that supports the FIRESTORE_EMULATOR_HOST environment variable, run:\n\n   export FIRESTORE_EMULATOR_HOST=0.0.0.0:9299\n\nDev App Server is now running.\n\nAug 05, 2023 7:03:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:05:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:05:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:05:26 PM com.google.cloud.datastore.emulator.firestore.websocket.WebSocketChannelHandler initChannel\nINFO: Connected to new websocket client\nAug 05, 2023 7:05:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:05:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:05:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:05:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:05:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:05:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:05:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:08:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:08:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:12 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:09:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:09:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:42 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:09:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:00 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:19 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nINFO: operation failed: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\ncom.google.cloud.datastore.core.exception.DatastoreException: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\n\tat com.google.cloud.datastore.core.exception.DatastoreException.withProblem(DatastoreException.java:184)\n\tat com.google.cloud.datastore.emulator.impl.util.FirestoreEmulatorConverters.checkMutation(FirestoreEmulatorConverters.java:169)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:967)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:868)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:851)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.write(CloudFirestoreV1.java:840)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:208)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:136)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:92)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:25)\n\tat io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:330)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:313)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:833)\n\nAug 05, 2023 7:10:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:48 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:10:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:11:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:11:12 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:11:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:11:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:11:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:12:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:12:31 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nINFO: operation failed: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\ncom.google.cloud.datastore.core.exception.DatastoreException: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\n\tat com.google.cloud.datastore.core.exception.DatastoreException.withProblem(DatastoreException.java:184)\n\tat com.google.cloud.datastore.emulator.impl.util.FirestoreEmulatorConverters.checkMutation(FirestoreEmulatorConverters.java:169)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:967)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:868)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:851)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.write(CloudFirestoreV1.java:840)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:208)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:136)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:92)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:25)\n\tat io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:330)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:313)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:833)\n\nAug 05, 2023 7:12:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:12:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:13:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:14:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:14:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:14:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:14:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:15:15 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nINFO: operation failed: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\ncom.google.cloud.datastore.core.exception.DatastoreException: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\n\tat com.google.cloud.datastore.core.exception.DatastoreException.withProblem(DatastoreException.java:184)\n\tat com.google.cloud.datastore.emulator.impl.util.FirestoreEmulatorConverters.checkMutation(FirestoreEmulatorConverters.java:169)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:967)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:868)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:851)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.write(CloudFirestoreV1.java:840)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:208)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:136)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:92)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:25)\n\tat io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:330)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:313)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:833)\n\nAug 05, 2023 7:15:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:15:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:16:15 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nINFO: operation failed: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\ncom.google.cloud.datastore.core.exception.DatastoreException: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\n\tat com.google.cloud.datastore.core.exception.DatastoreException.withProblem(DatastoreException.java:184)\n\tat com.google.cloud.datastore.emulator.impl.util.FirestoreEmulatorConverters.checkMutation(FirestoreEmulatorConverters.java:169)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:967)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:868)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:851)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.write(CloudFirestoreV1.java:840)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:208)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:136)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:92)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:25)\n\tat io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:330)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:313)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:833)\n\nAug 05, 2023 7:16:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:16:48 PM com.google.cloud.datastore.emulator.impl.util.WrappedStreamObserver onError\nINFO: operation failed: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\ncom.google.cloud.datastore.core.exception.DatastoreException: no entity to update: app: \"dev~cyclistance-cc715\"\npath <\n  Element {\n    type: \"chats\"\n    name: \"GbILaFMlUImQgBOfr2BZ\"\n  }\n>\n\n\tat com.google.cloud.datastore.core.exception.DatastoreException.withProblem(DatastoreException.java:184)\n\tat com.google.cloud.datastore.emulator.impl.util.FirestoreEmulatorConverters.checkMutation(FirestoreEmulatorConverters.java:169)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.commitHelper(CloudFirestoreV1.java:967)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:868)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.internalCommit(CloudFirestoreV1.java:851)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1.write(CloudFirestoreV1.java:840)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.handleRequest(CloudFirestoreV1WriteStream.java:208)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.write(CloudFirestoreV1WriteStream.java:136)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:92)\n\tat com.google.cloud.datastore.emulator.impl.CloudFirestoreV1WriteStream.onNext(CloudFirestoreV1WriteStream.java:25)\n\tat io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)\n\tat io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:330)\n\tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:313)\n\tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n\tat java.base/java.lang.Thread.run(Thread.java:833)\n\nAug 05, 2023 7:17:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:17:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:18:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:19:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:19:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:20:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:20:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:20:48 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:21:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:22:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:23:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:24:23 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:25:39 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:26:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:27:41 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:28:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:28:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:29:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:30:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:31:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:32:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:33:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:35:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:36:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:37:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:38:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:39:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:40:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:41:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:42:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:42:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:43:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:43:39 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:44:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:44:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:46:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:46:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:47:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:47:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:48:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 7:48:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:50:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:51:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:52:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:53:22 PM io.netty.channel.DefaultChannelPipeline onUnhandledInboundException\nWARNING: An exceptionCaught() event was fired, and it reached at the tail of the pipeline. It usually means the last handler in the pipeline did not handle the exception.\njava.net.SocketException: Connection reset\n\tat java.base/sun.nio.ch.SocketChannelImpl.throwConnectionReset(SocketChannelImpl.java:394)\n\tat java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:426)\n\tat io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:253)\n\tat io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\tat java.base/java.lang.Thread.run(Thread.java:833)\n\nAug 05, 2023 7:53:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:54:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:55:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:55:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:57:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:58:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 7:58:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:00:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:00:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:02:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:02:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:03:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:04:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:06:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:07:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:08:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:09:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:10:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:11:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:12:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:13:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:14:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:15:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:16:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:17:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:18:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:19:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:20:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:21:41 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:22:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:22:08 PM io.netty.channel.DefaultChannelPipeline onUnhandledInboundException\nWARNING: An exceptionCaught() event was fired, and it reached at the tail of the pipeline. It usually means the last handler in the pipeline did not handle the exception.\njava.net.SocketException: Connection reset\n\tat java.base/sun.nio.ch.SocketChannelImpl.throwConnectionReset(SocketChannelImpl.java:394)\n\tat java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:426)\n\tat io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:253)\n\tat io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)\n\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\tat java.base/java.lang.Thread.run(Thread.java:833)\n\nAug 05, 2023 8:22:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:22:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:23:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:23:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:23:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:25:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:26:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:26:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:27:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:27:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:28:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:29:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:29:28 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:30:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:30:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:31:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:32:12 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:33:28 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:34:44 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:36:00 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:37:00 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:38:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:38:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 8:39:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:40:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:41:04 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:42:04 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:42:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:43:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:44:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:45:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:46:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:48:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:48:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:50:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:51:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:52:42 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:53:42 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:54:28 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:55:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:56:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:57:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:58:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 8:59:23 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:00:39 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:01:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:02:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 9:03:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:03:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:00 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:04 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:06 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:12 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:20 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:39 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:41 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:04:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:05:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:06:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:07:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:07:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:08:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:09:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:10:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:11:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:28 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:39 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:41 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:12:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:23 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:13:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:14:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:39 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:41 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:15:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:16:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:17:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:17:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected HTTP/2 connection.\nAug 05, 2023 9:18:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:18:28 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:18:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:19:20 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:20:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:21:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:22:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:23:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:23:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:25:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:26:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:26:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:26:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\nAug 05, 2023 9:26:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead\nINFO: Detected non-HTTP/2 connection.\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/firestore-debug.log b/firestore-debug.log
--- a/firestore-debug.log	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/firestore-debug.log	(date 1691250989463)
@@ -900,3 +900,629 @@
 INFO: Detected non-HTTP/2 connection.
 Aug 05, 2023 9:26:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
 INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:26:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:41 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:27:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:28:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:29:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:29:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:29:26 PM io.netty.channel.DefaultChannelPipeline onUnhandledInboundException
+WARNING: An exceptionCaught() event was fired, and it reached at the tail of the pipeline. It usually means the last handler in the pipeline did not handle the exception.
+java.net.SocketException: Connection reset
+	at java.base/sun.nio.ch.SocketChannelImpl.throwConnectionReset(SocketChannelImpl.java:394)
+	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:426)
+	at io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:253)
+	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
+	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
+	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
+	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
+	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
+	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
+	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
+	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
+	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
+	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
+	at java.base/java.lang.Thread.run(Thread.java:833)
+
+Aug 05, 2023 9:29:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:30:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:30:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:30:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:31:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:31:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:31:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:32:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:32:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:32:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:12 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:20 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:33:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:34:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:34:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:34:48 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:34:48 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:35:06 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:35:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:35:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:36:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:37:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:37:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:37:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:38:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:39:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:39:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:40:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:40:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:41:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:42:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:42:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:42:37 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:43:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:44:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:45:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:46:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:47:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:47:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:47:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 9:47:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:48:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:49:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:50:31 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:51:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:52:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:53:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:54:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:55:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:56:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:56:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:57:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 9:58:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:00:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:00:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:02:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:02:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:03:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:04:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:05:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:06:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:08:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:09:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:10:03 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:11:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:12:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:13:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:14:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:15:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:15:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:17:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:17:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:18:41 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:19:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:45 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:19:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:04 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:10 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:12 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:20 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:20:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:28 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:38 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:40 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:42 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:44 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:48 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:20:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:21:12 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:21:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:22:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:23:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:24:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:24:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:24:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:25:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:26:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:27:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:27:44 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:28:16 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:28:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:29:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:31:02 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:32:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:33:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:34:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:35:20 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:36:06 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:37:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:38:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:38:28 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:39:43 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:40:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:41:17 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:41:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:42:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:42:35 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:43:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:44:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:44:53 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:46:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:47:25 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:48:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:48:57 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:50:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:50:59 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:52:15 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:53:01 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:53:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:54:33 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:55:49 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:55:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:55:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:55:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:55:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 10:55:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:55:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:55:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:56:00 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:57:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:58:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 10:59:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:00:05 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:01:21 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:02:07 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:03:23 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:04:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:04:55 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:05:41 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:06:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:07:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:09 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:11 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:27 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:34 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:36 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:38 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:40 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:42 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:44 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:48 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:52 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:08:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:09:00 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:09:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:09:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:10:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:11:29 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:12:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 11:12:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:13:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:14:00 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:14:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 11:14:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:15:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:16:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:17:19 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 11:17:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:18:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:19:18 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:20:04 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:21:04 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:21:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:22:50 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:24:06 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:25:22 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:26:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:26:54 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:27:40 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:28:26 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:29:12 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:29:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:30:44 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:32:00 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:32:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:32:47 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 11:33:32 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:34:08 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 11:34:38 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:35:24 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:36:40 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:37:40 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:38:40 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:39:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:40:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:41:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:42:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:43:56 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:44:42 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:45:42 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:46:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:47:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:49:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:50:14 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:51:30 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:52:46 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:52:48 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:52:48 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:52:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:52:51 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:52:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected HTTP/2 connection.
+Aug 05, 2023 11:53:58 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
+Aug 05, 2023 11:55:13 PM io.gapi.emulators.netty.HttpVersionRoutingHandler channelRead
+INFO: Detected non-HTTP/2 connection.
Index: app/src/main/java/com/example/cyclistance/feature_messaging/presentation/search_user/SearchUserScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.feature_messaging.presentation.search_user\n\nimport androidx.activity.compose.BackHandler\nimport androidx.compose.foundation.layout.PaddingValues\nimport androidx.compose.foundation.layout.fillMaxSize\nimport androidx.compose.foundation.layout.padding\nimport androidx.compose.runtime.Composable\nimport androidx.compose.runtime.getValue\nimport androidx.compose.runtime.mutableStateOf\nimport androidx.compose.runtime.remember\nimport androidx.compose.runtime.saveable.rememberSaveable\nimport androidx.compose.runtime.setValue\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.focus.FocusRequester\nimport androidx.compose.ui.text.input.TextFieldValue\nimport androidx.hilt.navigation.compose.hiltViewModel\nimport androidx.lifecycle.compose.collectAsStateWithLifecycle\nimport androidx.navigation.NavController\nimport com.example.cyclistance.feature_messaging.domain.model.ui.chats.MessagingUserItemModel\nimport com.example.cyclistance.feature_messaging.presentation.search_user.components.SearchUserContent\nimport com.example.cyclistance.feature_messaging.presentation.search_user.event.SearchUserUiEvent\nimport com.example.cyclistance.navigation.Screens\nimport com.example.cyclistance.navigation.nav_graph.navigateScreen\nimport java.net.URLEncoder\nimport java.nio.charset.StandardCharsets\n\n@Composable\nfun SearchUserScreen(\n    viewModel: SearchUserViewModel = hiltViewModel(),\n    navController: NavController,\n    paddingValues: PaddingValues) {\n    val focusRequester = remember { FocusRequester() }\n    val state by viewModel.state.collectAsStateWithLifecycle()\n    var searchQuery by rememberSaveable(stateSaver = TextFieldValue.Saver) {\n        mutableStateOf(\n            TextFieldValue())\n    }\n\n\n    val closeMessagingScreen = remember {\n        {\n            navController.popBackStack()\n        }\n    }\n    val onSelectConversation = remember {\n        { chatItem: MessagingUserItemModel ->\n            val encodedUrl =\n                URLEncoder.encode(chatItem.userDetails.photo, StandardCharsets.UTF_8.toString())\n            navController.navigateScreen(\n                route = \"${Screens.MessagingNavigation.ConversationScreen.screenRoute}/${chatItem.userDetails.uid}/$encodedUrl/${chatItem.userDetails.name}/${chatItem.userAvailability}\",\n            )\n        }\n    }\n\n\n    val onSearchQueryChanged = remember {\n        { input: TextFieldValue ->\n            searchQuery = input\n        }\n    }\n\n    val onClearSearchQuery = remember {\n        {\n            searchQuery = TextFieldValue()\n        }\n    }\n\n    BackHandler {\n        closeMessagingScreen()\n    }\n\n\n    SearchUserContent(\n        modifier = Modifier.fillMaxSize().padding(paddingValues = paddingValues),\n        searchQuery = searchQuery,\n        focusRequester = focusRequester,\n        state = state,\n        event = { event ->\n            when (event) {\n                is SearchUserUiEvent.OnSelectConversation -> onSelectConversation(event.messageUser)\n                is SearchUserUiEvent.CloseScreen -> closeMessagingScreen()\n                is SearchUserUiEvent.OnSearchQueryChanged -> onSearchQueryChanged(event.searchQuery)\n                is SearchUserUiEvent.ClearSearchQuery -> onClearSearchQuery()\n            }\n        }\n    )\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/search_user/SearchUserScreen.kt b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/search_user/SearchUserScreen.kt
--- a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/search_user/SearchUserScreen.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/search_user/SearchUserScreen.kt	(date 1691246752119)
@@ -21,8 +21,6 @@
 import com.example.cyclistance.feature_messaging.presentation.search_user.event.SearchUserUiEvent
 import com.example.cyclistance.navigation.Screens
 import com.example.cyclistance.navigation.nav_graph.navigateScreen
-import java.net.URLEncoder
-import java.nio.charset.StandardCharsets
 
 @Composable
 fun SearchUserScreen(
@@ -43,11 +41,15 @@
         }
     }
     val onSelectConversation = remember {
-        { chatItem: MessagingUserItemModel ->
-            val encodedUrl =
-                URLEncoder.encode(chatItem.userDetails.photo, StandardCharsets.UTF_8.toString())
+        { user: MessagingUserItemModel ->
+
             navController.navigateScreen(
-                route = "${Screens.MessagingNavigation.ConversationScreen.screenRoute}/${chatItem.userDetails.uid}/$encodedUrl/${chatItem.userDetails.name}/${chatItem.userAvailability}",
+                route = Screens.MessagingNavigation.ConversationScreen.screenRoute,
+            )
+
+            navController.currentBackStackEntry?.savedStateHandle?.set(
+                key = "user",
+                value = user
             )
         }
     }
Index: app/src/main/java/com/example/cyclistance/feature_messaging/presentation/chat/chats/ChatsScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.feature_messaging.presentation.chat.chats\n\nimport androidx.compose.foundation.layout.PaddingValues\nimport androidx.compose.foundation.layout.padding\nimport androidx.compose.runtime.Composable\nimport androidx.compose.runtime.getValue\nimport androidx.compose.runtime.remember\nimport androidx.compose.ui.Modifier\nimport androidx.hilt.navigation.compose.hiltViewModel\nimport androidx.lifecycle.compose.collectAsStateWithLifecycle\nimport androidx.navigation.NavController\nimport com.example.cyclistance.feature_messaging.domain.model.ui.chats.MessagingUserItemModel\nimport com.example.cyclistance.feature_messaging.presentation.chat.chats.components.ChatScreenContent\nimport com.example.cyclistance.feature_messaging.presentation.chat.chats.event.ChatUiEvent\nimport com.example.cyclistance.feature_messaging.presentation.chat.chats.event.ChatVmEvent\nimport com.example.cyclistance.navigation.Screens\nimport com.example.cyclistance.navigation.nav_graph.navigateScreen\nimport java.net.URLEncoder\nimport java.nio.charset.StandardCharsets\n\n@Composable\nfun ChatsScreen(\n    viewModel: ChatsViewModel = hiltViewModel(),\n    navController: NavController,\n    paddingValues: PaddingValues,\n    isInternetAvailable: Boolean) {\n\n    val state by viewModel.state.collectAsStateWithLifecycle()\n    val chatState = viewModel.chatsState.distinctBy { it.second.conversionId }\n\n\n    val onSelectConversation = remember {\n        { user: MessagingUserItemModel ->\n            val encodedUrl =\n                URLEncoder.encode(user.userDetails.photo, StandardCharsets.UTF_8.toString())\n            navController.navigateScreen(\n                route = \"${Screens.MessagingNavigation.ConversationScreen.screenRoute}/${user.userDetails.uid}/$encodedUrl/${user.userDetails.name}/${user.userAvailability}\",\n            )\n        }\n    }\n\n    val onRefreshChats = remember{{\n        viewModel.onEvent(event = ChatVmEvent.RefreshChat)\n    }}\n\n\n    ChatScreenContent(\n        chatState = chatState,\n        state = state,\n        modifier = Modifier.padding(paddingValues),\n        isInternetAvailable = isInternetAvailable,\n        event = { event ->\n            when (event) {\n                is ChatUiEvent.OnSelectConversation -> onSelectConversation(event.user)\n                is ChatUiEvent.OnRefreshChat -> onRefreshChats()\n            }\n        }\n    )\n\n\n\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/chat/chats/ChatsScreen.kt b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/chat/chats/ChatsScreen.kt
--- a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/chat/chats/ChatsScreen.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/chat/chats/ChatsScreen.kt	(date 1691248020718)
@@ -15,8 +15,6 @@
 import com.example.cyclistance.feature_messaging.presentation.chat.chats.event.ChatVmEvent
 import com.example.cyclistance.navigation.Screens
 import com.example.cyclistance.navigation.nav_graph.navigateScreen
-import java.net.URLEncoder
-import java.nio.charset.StandardCharsets
 
 @Composable
 fun ChatsScreen(
@@ -31,10 +29,12 @@
 
     val onSelectConversation = remember {
         { user: MessagingUserItemModel ->
-            val encodedUrl =
-                URLEncoder.encode(user.userDetails.photo, StandardCharsets.UTF_8.toString())
-            navController.navigateScreen(
-                route = "${Screens.MessagingNavigation.ConversationScreen.screenRoute}/${user.userDetails.uid}/$encodedUrl/${user.userDetails.name}/${user.userAvailability}",
+
+            navController.navigateScreen(route = Screens.MessagingNavigation.ConversationScreen.screenRoute)
+
+            navController.currentBackStackEntry?.savedStateHandle?.set(
+                key = "user",
+                value = user
             )
         }
     }
Index: app/src/main/java/com/example/cyclistance/navigation/NavScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.navigation\n\nimport android.widget.Toast\nimport androidx.activity.compose.BackHandler\nimport androidx.compose.foundation.layout.Column\nimport androidx.compose.foundation.layout.fillMaxSize\nimport androidx.compose.foundation.layout.fillMaxWidth\nimport androidx.compose.material.DrawerValue\nimport androidx.compose.material.Scaffold\nimport androidx.compose.material.Surface\nimport androidx.compose.material.rememberDrawerState\nimport androidx.compose.material.rememberScaffoldState\nimport androidx.compose.runtime.Composable\nimport androidx.compose.runtime.CompositionLocalProvider\nimport androidx.compose.runtime.LaunchedEffect\nimport androidx.compose.runtime.compositionLocalOf\nimport androidx.compose.runtime.getValue\nimport androidx.compose.runtime.mutableStateOf\nimport androidx.compose.runtime.remember\nimport androidx.compose.runtime.rememberCoroutineScope\nimport androidx.compose.runtime.saveable.rememberSaveable\nimport androidx.compose.runtime.setValue\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.platform.LocalContext\nimport androidx.compose.ui.platform.LocalLifecycleOwner\nimport androidx.compose.ui.unit.dp\nimport androidx.hilt.navigation.compose.hiltViewModel\nimport androidx.lifecycle.Lifecycle\nimport androidx.lifecycle.compose.collectAsStateWithLifecycle\nimport androidx.navigation.compose.currentBackStackEntryAsState\nimport androidx.navigation.compose.rememberNavController\nimport com.example.cyclistance.core.utils.composable_utils.ComposableLifecycle\nimport com.example.cyclistance.feature_authentication.domain.util.findActivity\nimport com.example.cyclistance.feature_mapping.data.data_source.local.network_observer.NetworkConnectivityChecker\nimport com.example.cyclistance.feature_mapping.presentation.mapping_main_screen.components.drawer.NavigationDrawerContent\nimport com.example.cyclistance.feature_settings.presentation.setting_edit_profile.EditProfileViewModel\nimport com.example.cyclistance.feature_settings.presentation.setting_edit_profile.event.EditProfileEvent\nimport com.example.cyclistance.feature_settings.presentation.setting_edit_profile.event.EditProfileVmEvent\nimport com.example.cyclistance.feature_settings.presentation.setting_screen.SettingEvent\nimport com.example.cyclistance.feature_settings.presentation.setting_screen.SettingViewModel\nimport com.example.cyclistance.feature_settings.presentation.setting_screen.event.SettingUiEvent\nimport com.example.cyclistance.navigation.components.NoInternetStatusBar\nimport com.example.cyclistance.navigation.components.TopAppBar\nimport com.example.cyclistance.navigation.event.NavEvent\nimport com.example.cyclistance.navigation.event.NavUiEvent\nimport com.example.cyclistance.navigation.event.NavVmEvent\nimport com.example.cyclistance.navigation.nav_graph.NavGraph\nimport com.example.cyclistance.navigation.nav_graph.navigateScreen\nimport com.example.cyclistance.navigation.nav_graph.navigateScreenInclusively\nimport com.example.cyclistance.navigation.state.NavUiState\nimport com.example.cyclistance.theme.CyclistanceTheme\nimport com.google.accompanist.permissions.ExperimentalPermissionsApi\nimport kotlinx.coroutines.flow.collectLatest\nimport kotlinx.coroutines.flow.distinctUntilChanged\nimport kotlinx.coroutines.launch\n\n\nval IsDarkTheme = compositionLocalOf { false }\n\n@OptIn(ExperimentalPermissionsApi::class)\n@Composable\nfun NavScreen(\n    settingViewModel: SettingViewModel = hiltViewModel(),\n    navViewModel: NavViewModel = hiltViewModel(),\n    editProfileViewModel: EditProfileViewModel = hiltViewModel()\n) {\n\n\n    var navUiState by rememberSaveable { mutableStateOf(NavUiState()) }\n    val navController = rememberNavController()\n    val context = LocalContext.current\n    val navBackStackEntry by navController.currentBackStackEntryAsState()\n    val scaffoldState =\n        rememberScaffoldState(drawerState = rememberDrawerState(initialValue = DrawerValue.Closed))\n    val coroutineScope = rememberCoroutineScope()\n    val settingState by settingViewModel.state.collectAsStateWithLifecycle()\n    val navState by navViewModel.state.collectAsStateWithLifecycle()\n    val lifecycleOwner = LocalLifecycleOwner.current\n\n    val onChangeNavigatingState = remember {\n        { navigating: Boolean ->\n            navUiState = navUiState.copy(\n                isNavigating = navigating\n            )\n        }\n    }\n\n\n    BackHandler(enabled = true, onBack = {\n        coroutineScope.launch {\n\n            if (scaffoldState.drawerState.isOpen) {\n                scaffoldState.drawerState.close()\n                return@launch\n            }\n\n            context.findActivity()?.finish()\n        }\n    })\n\n    ComposableLifecycle { _, event ->\n        when (event) {\n            Lifecycle.Event.ON_CREATE -> {\n                NetworkConnectivityChecker.observe(lifecycleOwner) { isConnected ->\n                    isConnected?.let {\n                        navUiState = navUiState.copy(internetAvailable = isConnected)\n                    }\n                }\n            }\n\n            Lifecycle.Event.ON_RESUME -> {\n                NetworkConnectivityChecker.checkForConnection()\n            }\n\n            else -> {}\n        }\n\n    }\n\n    LaunchedEffect(true) {\n        navViewModel.event.collectLatest { event ->\n            when (event) {\n                NavEvent.DeleteMessagingTokenSuccess -> {\n                    settingViewModel.onEvent(event = SettingEvent.SignOut)\n                }\n\n                is NavEvent.DeleteMessagingTokenFailure -> {\n                    Toast.makeText(context, event.message, Toast.LENGTH_LONG).show()\n                }\n            }\n        }\n    }\n\n\n\n    LaunchedEffect(key1 = true) {\n\n        editProfileViewModel.eventFlow.distinctUntilChanged().collect { event ->\n            when (event) {\n                is EditProfileEvent.GetNameSuccess -> {\n                    navUiState = navUiState.copy(drawerDisplayName = event.name)\n                }\n\n                is EditProfileEvent.GetPhotoUrlSuccess -> {\n                    navUiState = navUiState.copy(drawerPhotoUrl = event.photoUrl)\n                }\n\n                else -> {}\n            }\n        }\n    }\n\n    LaunchedEffect(key1 = true) {\n\n        settingViewModel.eventFlow.collectLatest { event ->\n            when (event) {\n\n                is SettingUiEvent.SignOutSuccess -> {\n\n                    navController.navigateScreenInclusively(\n                        Screens.AuthenticationNavigation.ROUTE,\n                        Screens.MappingNavigation.ROUTE)\n                }\n\n                is SettingUiEvent.SignOutFailed -> {\n                    Toast.makeText(context, \"Failed to Sign out account\", Toast.LENGTH_SHORT).show()\n                }\n\n            }\n        }\n    }\n\n    val closeDrawer = remember {\n        {\n            coroutineScope.launch {\n                scaffoldState.drawerState.close()\n            }\n        }\n    }\n\n    val onClickSettings = remember {\n        {\n            closeDrawer()\n            navController.navigate(\n                Screens.SettingsNavigation.ROUTE)\n        }\n    }\n\n\n    val onClickChat = remember {\n        {\n            closeDrawer()\n            navController.navigateScreen(Screens.MessagingNavigation.ROUTE)\n        }\n    }\n\n    val onClickSignOut = remember {\n        {\n            navViewModel.onEvent(NavVmEvent.DeleteMessagingToken)\n            closeDrawer()\n            Unit\n        }\n    }\n\n    val onClickEmergencyCall = remember {\n        {\n            closeDrawer()\n            navController.navigateScreen(Screens.EmergencyCallNavigation.ROUTE)\n        }\n    }\n\n    val onClickRideHistory = remember {\n        {\n            closeDrawer()\n            navController.navigateScreen(Screens.RideHistoryNavigation.ROUTE)\n        }\n    }\n\n    val onToggleTheme = remember {\n        {\n            settingViewModel.onEvent(event = SettingEvent.ToggleTheme)\n        }\n    }\n\n    val onClickArrowBackIcon = remember {\n        {\n            navController.popBackStack()\n            Unit\n        }\n    }\n\n    val onClickSearchMessagingUser = remember {\n        {\n            navController.navigateScreen(\n                route = Screens.MessagingNavigation.SearchUserScreen.screenRoute)\n        }\n    }\n\n    val onClickMenuIcon = remember {\n        {\n            editProfileViewModel.onEvent(event = EditProfileVmEvent.LoadProfile)\n            coroutineScope.launch {\n                scaffoldState.drawerState.open()\n            }\n            Unit\n        }\n    }\n\n    val newConversationDetails = remember {\n        { name: String, photoUrl: String, availability: Boolean->\n            navUiState = navUiState.copy(\n                conversationName = name,\n                conversationPhotoUrl = photoUrl,\n                conversationAvailability = availability\n            )\n        }\n    }\n\n\n\n\n    CompositionLocalProvider(IsDarkTheme provides settingState.isDarkTheme) {\n\n        CyclistanceTheme(darkTheme = settingState.isDarkTheme) {\n\n            Surface(\n                modifier = Modifier.fillMaxSize()) {\n\n                Scaffold(\n                    drawerGesturesEnabled = scaffoldState.drawerState.isOpen,\n                    scaffoldState = scaffoldState,\n                    topBar = {\n\n                        Surface(elevation = 10.dp, modifier = Modifier.fillMaxWidth()) {\n\n                            Column {\n\n                                TopAppBar(\n                                    route = navBackStackEntry?.destination?.route,\n                                    onClickMenuIcon = onClickMenuIcon,\n                                    onClickArrowBackIcon = onClickArrowBackIcon,\n                                    onClickSearchMessagingUser = onClickSearchMessagingUser,\n                                    uiState = navUiState)\n\n                                NoInternetStatusBar(\n                                    navUiState.internetAvailable,\n                                    navBackStackEntry?.destination?.route)\n\n                            }\n                        }\n                    },\n                    drawerContent = {\n                        NavigationDrawerContent(\n                            onClickSettings = onClickSettings,\n                            onClickChat = onClickChat,\n                            onClickSignOut = onClickSignOut,\n                            onClickEmergencyCall = onClickEmergencyCall,\n                            onClickRideHistory = onClickRideHistory,\n                            uiState = navUiState\n                        )\n                    },\n                ) { paddingValues ->\n                    navState.navigationStartingDestination?.let {\n                        NavGraph(\n                            uiState = navUiState.copy(startingDestination = it),\n                            navController = navController,\n                            paddingValues = paddingValues,\n                            event = { event ->\n                                when (event) {\n                                    is NavUiEvent.NewConversationDetails -> newConversationDetails(event.chatName, event.chatPhotoUrl, event.chatAvailability)\n                                    is NavUiEvent.OnChangeNavigation -> onChangeNavigatingState(event.isNavigating)\n                                    is NavUiEvent.OnToggleTheme -> onToggleTheme()\n                                }\n                            }\n                        )\n                    }\n                }\n            }\n        }\n    }\n\n}\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/navigation/NavScreen.kt b/app/src/main/java/com/example/cyclistance/navigation/NavScreen.kt
--- a/app/src/main/java/com/example/cyclistance/navigation/NavScreen.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/navigation/NavScreen.kt	(date 1691249182312)
@@ -33,6 +33,7 @@
 import com.example.cyclistance.feature_authentication.domain.util.findActivity
 import com.example.cyclistance.feature_mapping.data.data_source.local.network_observer.NetworkConnectivityChecker
 import com.example.cyclistance.feature_mapping.presentation.mapping_main_screen.components.drawer.NavigationDrawerContent
+import com.example.cyclistance.feature_messaging.domain.model.ui.chats.MessagingUserItemModel
 import com.example.cyclistance.feature_settings.presentation.setting_edit_profile.EditProfileViewModel
 import com.example.cyclistance.feature_settings.presentation.setting_edit_profile.event.EditProfileEvent
 import com.example.cyclistance.feature_settings.presentation.setting_edit_profile.event.EditProfileVmEvent
@@ -247,11 +248,11 @@
     }
 
     val newConversationDetails = remember {
-        { name: String, photoUrl: String, availability: Boolean->
+        { messageUser: MessagingUserItemModel ->
             navUiState = navUiState.copy(
-                conversationName = name,
-                conversationPhotoUrl = photoUrl,
-                conversationAvailability = availability
+                conversationName =  messageUser.userDetails.name,
+                conversationPhotoUrl =  messageUser.userDetails.photo,
+                conversationAvailability =  messageUser.userAvailability
             )
         }
     }
@@ -307,7 +308,7 @@
                             paddingValues = paddingValues,
                             event = { event ->
                                 when (event) {
-                                    is NavUiEvent.NewConversationDetails -> newConversationDetails(event.chatName, event.chatPhotoUrl, event.chatAvailability)
+                                    is NavUiEvent.NewConversationDetails -> newConversationDetails(event.conversationUser)
                                     is NavUiEvent.OnChangeNavigation -> onChangeNavigatingState(event.isNavigating)
                                     is NavUiEvent.OnToggleTheme -> onToggleTheme()
                                 }
Index: app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationViewModel.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.feature_messaging.presentation.conversation\n\nimport androidx.compose.runtime.mutableStateListOf\nimport androidx.lifecycle.SavedStateHandle\nimport androidx.lifecycle.ViewModel\nimport androidx.lifecycle.viewModelScope\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_AVAILABILITY\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_ID\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_NAME\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_PHOTO_URL\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.CONVERSATION_VM_STATE_KEY\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_LAST_MESSAGE\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_RECEIVER_ID\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_SENDER_ID\nimport com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_TIMESTAMP\nimport com.example.cyclistance.feature_messaging.domain.model.SendMessageModel\nimport com.example.cyclistance.feature_messaging.domain.model.ui.conversation.ConversationItemModel\nimport com.example.cyclistance.feature_messaging.domain.use_case.MessagingUseCase\nimport com.example.cyclistance.feature_messaging.presentation.conversation.event.ConversationEvent\nimport com.example.cyclistance.feature_messaging.presentation.conversation.event.ConversationVmEvent\nimport com.example.cyclistance.feature_messaging.presentation.conversation.state.ConversationState\nimport com.example.cyclistance.feature_settings.domain.use_case.SettingUseCase\nimport dagger.hilt.android.lifecycle.HiltViewModel\nimport kotlinx.coroutines.flow.MutableSharedFlow\nimport kotlinx.coroutines.flow.MutableStateFlow\nimport kotlinx.coroutines.flow.StateFlow\nimport kotlinx.coroutines.flow.asSharedFlow\nimport kotlinx.coroutines.flow.asStateFlow\nimport kotlinx.coroutines.flow.update\nimport kotlinx.coroutines.launch\nimport timber.log.Timber\nimport java.util.Date\nimport javax.inject.Inject\n\n@HiltViewModel\nclass ConversationViewModel @Inject constructor(\n    private val savedStateHandle: SavedStateHandle,\n    private val messagingUseCase: MessagingUseCase,\n    private val settingUseCase: SettingUseCase\n) : ViewModel() {\n\n\n    private val _chatName: String = savedStateHandle[CHAT_NAME]!!\n    private val _chatId: String = savedStateHandle[CHAT_ID]!!\n    private val _chatPhotoUrl: String = savedStateHandle[CHAT_PHOTO_URL]!!\n    private val _chatUserAvailability: Boolean = savedStateHandle[CHAT_AVAILABILITY]!!\n\n    private val _conversationState = mutableStateListOf<ConversationItemModel>()\n    val conversationState: List<ConversationItemModel> = _conversationState\n\n    private val _state = MutableStateFlow(\n        savedStateHandle[CONVERSATION_VM_STATE_KEY] ?: ConversationState(\n            conversationUid = _chatId,\n            conversationPhotoUrl = _chatPhotoUrl,\n            conversationName = _chatName,\n            conversationAvailability = _chatUserAvailability\n        ))\n\n    val state = _state.asStateFlow()\n\n    private val _event = MutableSharedFlow<ConversationEvent>()\n    val event = _event.asSharedFlow()\n\n\n    init {\n        addMessageListener(_chatId)\n        getConversionId()\n        getUid()\n        getName()\n        getPhoto()\n        saveState()\n    }\n\n    fun onEvent(event: ConversationVmEvent) {\n        when (event) {\n            is ConversationVmEvent.SendMessage -> sendMessage(event.sendMessageModel)\n        }\n        saveState()\n    }\n\n\n    private fun saveState() {\n        savedStateHandle[CONVERSATION_VM_STATE_KEY] = state.value\n    }\n\n\n    private fun getName(){\n        viewModelScope.launch {\n            runCatching {\n                settingUseCase.getNameUseCase()\n            }.onSuccess { name ->\n                _state.update { it.copy(userName = name) }\n            }.onFailure {\n                Timber.v(\"Failed to get name: ${it.message}\")\n            }\n        }\n    }\n\n    private fun getPhoto(){\n        viewModelScope.launch {\n            runCatching {\n                settingUseCase.getPhotoUrlUseCase()\n            }.onSuccess { photo ->\n                _state.update { it.copy(userPhoto = photo ) }\n            }.onFailure {\n                Timber.v(\"Failed to get photo: ${it.message}\")\n            }\n        }\n    }\n\n    private fun setConversion(message: String){\n        if(state.value.conversionId == null){\n            addConversion(message = message)\n            return\n        }\n        updateConversion(message = message)\n    }\n\n    private fun updateConversion(message: String){\n        val conversionId = state.value.conversionId\n        viewModelScope.launch {\n            runCatching {\n                messagingUseCase.updateConversionUseCase(message = message, conversionId = conversionId!!)\n            }.onSuccess {\n                Timber.v(\"Success to update conversion\")\n            }.onFailure {\n                Timber.e(\"Failed to update conversion: ${it.message}\")\n            }\n        }\n    }\n\n    private fun addConversion(message: String){\n        runCatching {\n            messagingUseCase.addConversionUseCase(\n                conversion = state.handleConversion(message),\n                onNewConversionId = { id ->\n                    _state.update { it.copy(conversionId = id) }\n                })\n        }.onSuccess {\n            Timber.v(\"Success to add conversion\")\n        }.onFailure {\n            Timber.e(\"Failed to add conversion: ${it.message}\")\n        }\n    }\n\n    private fun StateFlow<ConversationState>.handleConversion(message: String): HashMap<String, Any>{\n        return with(value){\n            hashMapOf(\n                KEY_SENDER_ID to userUid,\n                KEY_RECEIVER_ID to conversationUid,\n                KEY_LAST_MESSAGE to message,\n                KEY_TIMESTAMP to Date()\n            )\n        }\n    }\n\n    private fun getConversionId(){\n        viewModelScope.launch {\n            runCatching {\n                messagingUseCase.getConversionIdUseCase(receiverId = _chatId)\n            }.onSuccess { id ->\n                _state.update { it.copy(conversionId = id) }\n            }.onFailure {\n                Timber.e(\"Failed to get conversation id: ${it.message}\")\n            }\n        }\n    }\n\n    private fun getUid() {\n        runCatching {\n            messagingUseCase.getUidUseCase()\n        }.onSuccess { id ->\n            _state.update { it.copy(userUid = id) }\n        }.onFailure {\n            Timber.e(\"Failed to get uid: ${it.message}\")\n        }\n    }\n\n    private fun sendMessage(sendMessage: SendMessageModel) {\n        viewModelScope.launch {\n            runCatching {\n                messagingUseCase.sendMessageUseCase(sendMessage)\n            }.onSuccess {\n                _event.emit(ConversationEvent.MessageSent)\n                setConversion(sendMessage.message)\n            }.onFailure {\n                _event.emit(ConversationEvent.MessageNotSent)\n            }\n        }\n    }\n\n    private fun removeMessageListener() {\n        messagingUseCase.removeMessageListenerUseCase()\n    }\n\n    private fun isLoading(isLoading: Boolean){\n        _state.update { it.copy(isLoading = isLoading) }\n    }\n\n    private fun addMessageListener(receiverId: String) {\n        viewModelScope.launch {\n            runCatching {\n                isLoading(true)\n                messagingUseCase.addMessageListenerUseCase(\n                    receiverId = receiverId,\n                    onNewMessage = { conversation ->\n                        _conversationState.addAll(conversation.messages)\n                        isLoading(false)\n                    })\n            }.onSuccess {\n                Timber.v(\"Success to add message listener\")\n            }.onFailure {\n                isLoading(false)\n                Timber.e(\"Failed to add message listener ${it.message}\")\n            }\n        }\n    }\n\n\n    override fun onCleared() {\n        super.onCleared()\n        removeMessageListener()\n        _conversationState.clear()\n    }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationViewModel.kt b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationViewModel.kt
--- a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationViewModel.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationViewModel.kt	(date 1691250067035)
@@ -4,16 +4,13 @@
 import androidx.lifecycle.SavedStateHandle
 import androidx.lifecycle.ViewModel
 import androidx.lifecycle.viewModelScope
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_AVAILABILITY
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_ID
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_NAME
-import com.example.cyclistance.core.utils.constants.MessagingConstants.CHAT_PHOTO_URL
 import com.example.cyclistance.core.utils.constants.MessagingConstants.CONVERSATION_VM_STATE_KEY
 import com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_LAST_MESSAGE
 import com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_RECEIVER_ID
 import com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_SENDER_ID
 import com.example.cyclistance.core.utils.constants.MessagingConstants.KEY_TIMESTAMP
 import com.example.cyclistance.feature_messaging.domain.model.SendMessageModel
+import com.example.cyclistance.feature_messaging.domain.model.SendNotificationModel
 import com.example.cyclistance.feature_messaging.domain.model.ui.conversation.ConversationItemModel
 import com.example.cyclistance.feature_messaging.domain.use_case.MessagingUseCase
 import com.example.cyclistance.feature_messaging.presentation.conversation.event.ConversationEvent
@@ -21,6 +18,7 @@
 import com.example.cyclistance.feature_messaging.presentation.conversation.state.ConversationState
 import com.example.cyclistance.feature_settings.domain.use_case.SettingUseCase
 import dagger.hilt.android.lifecycle.HiltViewModel
+import kotlinx.coroutines.Job
 import kotlinx.coroutines.flow.MutableSharedFlow
 import kotlinx.coroutines.flow.MutableStateFlow
 import kotlinx.coroutines.flow.StateFlow
@@ -40,21 +38,13 @@
 ) : ViewModel() {
 
 
-    private val _chatName: String = savedStateHandle[CHAT_NAME]!!
-    private val _chatId: String = savedStateHandle[CHAT_ID]!!
-    private val _chatPhotoUrl: String = savedStateHandle[CHAT_PHOTO_URL]!!
-    private val _chatUserAvailability: Boolean = savedStateHandle[CHAT_AVAILABILITY]!!
+
+    private var messageListenerJob: Job? = null
 
     private val _conversationState = mutableStateListOf<ConversationItemModel>()
     val conversationState: List<ConversationItemModel> = _conversationState
 
-    private val _state = MutableStateFlow(
-        savedStateHandle[CONVERSATION_VM_STATE_KEY] ?: ConversationState(
-            conversationUid = _chatId,
-            conversationPhotoUrl = _chatPhotoUrl,
-            conversationName = _chatName,
-            conversationAvailability = _chatUserAvailability
-        ))
+    private val _state = MutableStateFlow(savedStateHandle[CONVERSATION_VM_STATE_KEY] ?: ConversationState())
 
     val state = _state.asStateFlow()
 
@@ -63,7 +53,7 @@
 
 
     init {
-        addMessageListener(_chatId)
+
         getConversionId()
         getUid()
         getName()
@@ -74,11 +64,18 @@
     fun onEvent(event: ConversationVmEvent) {
         when (event) {
             is ConversationVmEvent.SendMessage -> sendMessage(event.sendMessageModel)
+
+            is ConversationVmEvent.OnSelectedConversation -> {
+                val receiverUid = event.messageUser.userDetails.uid
+                _state.update { it.copy(messageUser = event.messageUser) }
+                addMessageListener(receiverUid = receiverUid)
+            }
         }
         saveState()
     }
 
 
+
     private fun saveState() {
         savedStateHandle[CONVERSATION_VM_STATE_KEY] = state.value
     }
@@ -147,7 +144,7 @@
         return with(value){
             hashMapOf(
                 KEY_SENDER_ID to userUid,
-                KEY_RECEIVER_ID to conversationUid,
+                KEY_RECEIVER_ID to messageUser.userDetails.uid,
                 KEY_LAST_MESSAGE to message,
                 KEY_TIMESTAMP to Date()
             )
@@ -157,7 +154,8 @@
     private fun getConversionId(){
         viewModelScope.launch {
             runCatching {
-                messagingUseCase.getConversionIdUseCase(receiverId = _chatId)
+                val selectedUserUid = state.value.messageUser.userDetails.uid
+                messagingUseCase.getConversionIdUseCase(receiverId = selectedUserUid)
             }.onSuccess { id ->
                 _state.update { it.copy(conversionId = id) }
             }.onFailure {
@@ -180,6 +178,11 @@
         viewModelScope.launch {
             runCatching {
                 messagingUseCase.sendMessageUseCase(sendMessage)
+                messagingUseCase.sendNotificationUseCase(SendNotificationModel(
+                    receiverToken = "eeCh5ORqTWCoihV43vTNTJ:APA91bHL2QRJWqmNap5X9xR46qzZNXh_632GlIHgco5fdO2Fg-Pbul_2RyO-E3lUgsJ7E_weQE3FvSOYQSLA1c8ubVei9xnUgDiA3cpQrvO8tzPtQxuiC-3smH_KyrfFIwks0xkwi_-2",
+                    senderName = state.value.userName,
+                    message = sendMessage.message
+                ))
             }.onSuccess {
                 _event.emit(ConversationEvent.MessageSent)
                 setConversion(sendMessage.message)
@@ -197,12 +200,17 @@
         _state.update { it.copy(isLoading = isLoading) }
     }
 
-    private fun addMessageListener(receiverId: String) {
-        viewModelScope.launch {
+    private fun addMessageListener(receiverUid: String) {
+
+        if(messageListenerJob?.isActive == true) {
+            return
+        }
+
+        messageListenerJob = viewModelScope.launch {
             runCatching {
                 isLoading(true)
                 messagingUseCase.addMessageListenerUseCase(
-                    receiverId = receiverId,
+                    receiverId = receiverUid,
                     onNewMessage = { conversation ->
                         _conversationState.addAll(conversation.messages)
                         isLoading(false)
@@ -221,5 +229,6 @@
         super.onCleared()
         removeMessageListener()
         _conversationState.clear()
+        messageListenerJob?.cancel()
     }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.feature_messaging.presentation.conversation\n\nimport androidx.activity.compose.BackHandler\nimport androidx.compose.foundation.layout.PaddingValues\nimport androidx.compose.foundation.layout.fillMaxSize\nimport androidx.compose.foundation.layout.padding\nimport androidx.compose.runtime.Composable\nimport androidx.compose.runtime.LaunchedEffect\nimport androidx.compose.runtime.getValue\nimport androidx.compose.runtime.mutableStateOf\nimport androidx.compose.runtime.remember\nimport androidx.compose.runtime.saveable.rememberSaveable\nimport androidx.compose.runtime.setValue\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.text.input.TextFieldValue\nimport androidx.hilt.navigation.compose.hiltViewModel\nimport androidx.lifecycle.compose.collectAsStateWithLifecycle\nimport androidx.navigation.NavController\nimport com.example.cyclistance.feature_messaging.domain.model.SendMessageModel\nimport com.example.cyclistance.feature_messaging.presentation.conversation.components.ConversationContent\nimport com.example.cyclistance.feature_messaging.presentation.conversation.event.ConversationUiEvent\nimport com.example.cyclistance.feature_messaging.presentation.conversation.event.ConversationVmEvent\nimport com.example.cyclistance.feature_messaging.presentation.conversation.state.ConversationUiState\n\n@Composable\nfun ConversationScreen(\n    viewModel: ConversationViewModel = hiltViewModel(),\n    navController: NavController,\n    paddingValues: PaddingValues,\n    newConversationDetails: (name: String, photoUrl: String, availability: Boolean) -> Unit\n) {\n\n\n    val conversationState = viewModel.conversationState\n    val state by viewModel.state.collectAsStateWithLifecycle()\n    var uiState by rememberSaveable { mutableStateOf(ConversationUiState()) }\n    var message by rememberSaveable(stateSaver = TextFieldValue.Saver) {\n        mutableStateOf(TextFieldValue())\n    }\n\n    val onToggleExpand = remember {\n        {\n            uiState = uiState.copy(\n                messageAreaExpanded = !uiState.messageAreaExpanded\n            )\n        }\n    }\n    val onChangeValueMessage = remember<(TextFieldValue) -> Unit> {\n        {\n            message = it\n        }\n    }\n\n    val onClickChatItem = remember {\n        { index: Int ->\n            uiState = uiState.copy(\n                chatItemSelectedIndex = if (uiState.chatItemSelectedIndex == index) {\n                    -1\n                } else {\n                    index\n                })\n        }\n    }\n\n    val resetSelectedIndex = remember {\n        {\n            uiState = uiState.copy(\n                chatItemSelectedIndex = -1\n            )\n        }\n    }\n\n    val closeConversationMessage = remember {\n        {\n            navController.popBackStack()\n        }\n    }\n\n    val onSendMessage = remember {\n        {\n            viewModel.onEvent(\n                event = ConversationVmEvent.SendMessage(\n                    sendMessageModel = SendMessageModel(\n                        receiverId = state.conversationUid,\n                        message = message.text\n                    )\n                )).also {\n                message = TextFieldValue()\n            }\n\n        }\n    }\n\n    BackHandler(enabled = true, onBack = {\n        if (uiState.messageAreaExpanded) {\n            onToggleExpand()\n        } else {\n            navController.popBackStack()\n        }\n    })\n\n    LaunchedEffect(key1 = state.conversationName, key2 = state.conversationPhotoUrl, key3 = state.conversationAvailability) {\n        newConversationDetails(\n             state.conversationName,\n             state.conversationPhotoUrl,\n             state.conversationAvailability\n        )\n    }\n\n\n    ConversationContent(\n        conversation = conversationState,\n        modifier = Modifier\n            .fillMaxSize()\n            .padding(paddingValues = paddingValues),\n        uiState = uiState,\n        state = state,\n        message = message,\n        event = { event ->\n            when (event) {\n                ConversationUiEvent.CloseConversationScreen -> closeConversationMessage()\n                ConversationUiEvent.OnSendMessage -> onSendMessage()\n                ConversationUiEvent.ResetSelectedIndex -> resetSelectedIndex()\n                is ConversationUiEvent.SelectChatItem -> onClickChatItem(event.index)\n                ConversationUiEvent.ToggleMessageArea -> onToggleExpand()\n                is ConversationUiEvent.OnChangeValueMessage -> onChangeValueMessage(event.message)\n            }\n        }\n    )\n}\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationScreen.kt b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationScreen.kt
--- a/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationScreen.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/feature_messaging/presentation/conversation/ConversationScreen.kt	(date 1691250086037)
@@ -17,6 +17,7 @@
 import androidx.lifecycle.compose.collectAsStateWithLifecycle
 import androidx.navigation.NavController
 import com.example.cyclistance.feature_messaging.domain.model.SendMessageModel
+import com.example.cyclistance.feature_messaging.domain.model.ui.chats.MessagingUserItemModel
 import com.example.cyclistance.feature_messaging.presentation.conversation.components.ConversationContent
 import com.example.cyclistance.feature_messaging.presentation.conversation.event.ConversationUiEvent
 import com.example.cyclistance.feature_messaging.presentation.conversation.event.ConversationVmEvent
@@ -27,7 +28,8 @@
     viewModel: ConversationViewModel = hiltViewModel(),
     navController: NavController,
     paddingValues: PaddingValues,
-    newConversationDetails: (name: String, photoUrl: String, availability: Boolean) -> Unit
+    selectedUser: MessagingUserItemModel,
+    newConversationDetails: (MessagingUserItemModel) -> Unit
 ) {
 
 
@@ -81,7 +83,7 @@
             viewModel.onEvent(
                 event = ConversationVmEvent.SendMessage(
                     sendMessageModel = SendMessageModel(
-                        receiverId = state.conversationUid,
+                        receiverId = state.messageUser.userDetails.uid,
                         message = message.text
                     )
                 )).also {
@@ -99,12 +101,9 @@
         }
     })
 
-    LaunchedEffect(key1 = state.conversationName, key2 = state.conversationPhotoUrl, key3 = state.conversationAvailability) {
-        newConversationDetails(
-             state.conversationName,
-             state.conversationPhotoUrl,
-             state.conversationAvailability
-        )
+    LaunchedEffect(selectedUser) {
+        newConversationDetails(selectedUser)
+        viewModel.onEvent(event = ConversationVmEvent.OnSelectedConversation(messageUser = selectedUser))
     }
 
 
Index: app/src/main/java/com/example/cyclistance/core/utils/constants/MessagingConstants.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.cyclistance.core.utils.constants\n\nimport android.app.NotificationManager\nimport android.os.Build\nimport androidx.annotation.RequiresApi\nimport androidx.datastore.preferences.core.stringPreferencesKey\n\nobject MessagingConstants {\n    const val MESSAGING_VM_STATE_KEY = \"messaging_vm_state_key\"\n    const val CONVERSATION_VM_STATE_KEY = \"conversation_vm_state_key\"\n    const val SEARCH_USER_VM_STATE_KEY = \"search_user_vm_state_key\"\n    const val KEY_FCM_TOKEN = \"fcmToken\"\n    const val KEY_EMAIL = \"email\"\n    const val KEY_PHOTO = \"photo\"\n    const val KEY_NAME = \"name\"\n    const val KEY_UID = \"uid\"\n\n    const val KEY_SENDER_ID = \"senderId\"\n    const val KEY_RECEIVER_ID = \"receiverId\"\n    const val KEY_MESSAGE = \"message\"\n    const val KEY_TIMESTAMP = \"timestamp\"\n    val SAVED_TOKEN = stringPreferencesKey(\"saved_token\")\n\n    const val CHAT_ID = \"chatId\"\n    const val CHAT_PHOTO_URL = \"chatPhotoUrl\"\n    const val CHAT_NAME = \"chatName\"\n    const val CHAT_AVAILABILITY = \"chatAvailability\"\n\n    const val KEY_CONVERSATIONS_COLLECTION = \"conversations\"\n    const val KEY_COLLECTION_CHATS = \"chats\"\n    const val USER_COLLECTION = \"users\"\n    const val KEY_LAST_MESSAGE = \"lastMessage\"\n    const val KEY_AVAILABILITY = \"availability\"\n\n    const val REMOTE_MSG_AUTHORIZATION = \"Authorization\"\n    const val REMOTE_MSG_CONTENT_TYPE = \"Content-Type\"\n    const val REMOTE_MSG_CONTENT_FORMAT = \"application/json\"\n    const val REMOTE_MSG_DATA = \"data\"\n    const val REMOTE_MSG_REGISTRATION_IDS = \"registration_ids\"\n    const val MESSAGING_NOTIFICATION_ID = 101\n    const val MESSAGING_NOTIFICATION_CHANNEL = \"messaging_notification_channel\"\n\n    const val NOTIFICATION_REQUEST_CODE = 200\n    const val CHANNEL_NAME = \"Messaging\"\n    const val CHANNEL_DESCRIPTION = \"Messaging Notifications\"\n    @RequiresApi(Build.VERSION_CODES.N)\n    const val CHANNEL_IMPORTANCE = NotificationManager.IMPORTANCE_HIGH\n\n\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/cyclistance/core/utils/constants/MessagingConstants.kt b/app/src/main/java/com/example/cyclistance/core/utils/constants/MessagingConstants.kt
--- a/app/src/main/java/com/example/cyclistance/core/utils/constants/MessagingConstants.kt	(revision f7430ea7a03bc942601831fa1c69153fd6ceee47)
+++ b/app/src/main/java/com/example/cyclistance/core/utils/constants/MessagingConstants.kt	(date 1691246752109)
@@ -21,10 +21,7 @@
     const val KEY_TIMESTAMP = "timestamp"
     val SAVED_TOKEN = stringPreferencesKey("saved_token")
 
-    const val CHAT_ID = "chatId"
-    const val CHAT_PHOTO_URL = "chatPhotoUrl"
-    const val CHAT_NAME = "chatName"
-    const val CHAT_AVAILABILITY = "chatAvailability"
+
 
     const val KEY_CONVERSATIONS_COLLECTION = "conversations"
     const val KEY_COLLECTION_CHATS = "chats"
